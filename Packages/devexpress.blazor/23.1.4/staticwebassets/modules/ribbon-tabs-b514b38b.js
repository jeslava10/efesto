import{_ as t}from"./_tslib-6e8ca86b.js";import{d as e}from"./dom-f93f7533.js";import{S as i}from"./scroll-viewer-css-classes-af8d2aac.js";import{T as o}from"./toolbar-css-classes-98be7512.js";import{C as n}from"./css-classes-f3f8ed66.js";import{u as s,R as l,f as r,p as a,o as c,M as h,I as d,c as u,E as m,N as p}from"./dom-utils-04e3c6d2.js";import{U as b}from"./ribbon-utils-1f8753d1.js";import{a as f,R as v}from"./rect-00eb3fa4.js";import{attachEventsForFocusHiding as S}from"./focus-utils-cd9c9bc2.js";import{S as g}from"./single-slot-element-base-d44a6577.js";import{e as T}from"./property-d3853089.js";import{e as C}from"./custom-element-267f9a21.js";import"./point-e4ec110e.js";import"./touch-b17c92da.js";import"./disposable-d2c2d283.js";import"./data-qa-utils-8be7c726.js";import"./dx-ui-element-7f5e2dd2.js";import"./logicaltreehelper-bc8e12d3.js";import"./layouthelper-dc0e1370.js";import"./constants-58283e53.js";import"./lit-element-base-7a85dca5.js";import"./lit-element-70cf14f4.js";class E{}var x,B;E.Prefix=n.Prefix+"-tabs",E.Item=E.Prefix+"-item",E.Content=E.Prefix+"-content",E.TabList=E.Prefix+"-tablist",E.ContentPanel=E.Content+"-panel",E.Scrollable=E.TabList+"-scrollable",E.HasOverflow=E.TabList+"-has-overflow",E.ButtonScroll=E.Prefix+"-scroll-btn",E.ButtonScrollNext=E.ButtonScroll+"-next",E.ButtonScrollPrev=E.ButtonScroll+"-prev",function(t){t[t.None=0]="None",t[t.Back=1]="Back",t[t.Forward=2]="Forward"}(x||(x={}));class w{static calculate(t,e,i,o,n,s){const l=e?i.height:i.width,r=e?o.bottom:o.right,a=e?o.top:o.left,c=e?i.bottom:i.right,h=e?i.top:i.left,d=s?e?s.bottom:s.right:0,u=n?e?n.top:n.left:0;let m=a-h;switch(t){case x.Forward:m=Math.round(r-c),0===Math.round(m)&&s&&(m=Math.round(d-c)),m=Math.min(Math.max(0,m),l),0===m&&(m=l);break;case x.Back:m=Math.round(a)-Math.round(h),0===Math.round(m)&&n&&(m=Math.round(u-h)),m=-Math.min(Math.max(0,Math.abs(m)),l),0===m&&(m=-l);break;default:{const t=a<h,e=r>c;if(!t&&!e)return 0;if(e){const t=s?d-c:0;m=s&&a-t>=h?m=t:r-c}else if(t){const t=-a+h,e=n?-u+h:0;m=n&&r+e<=c?-e:r+t<=c?-t:0}break}}return Math.ceil(m)}}const M="data-dxtabs-tab-id",k="data-dxtabs-content-id",y=`.${E.Scrollable}`;var N,L,R,P;!function(t){t.Default="Default",t.AllTabs="AllTabs",t.OnDemand="OnDemand"}(N||(N={})),function(t){t.Auto="Auto",t.NavButtons="NavButtons",t.Swipe="Swipe",t.NoScroll="NoScroll"}(L||(L={})),function(t){t.Small="Small",t.Medium="Medium",t.Large="Large"}(R||(R={})),function(t){t.Top="Top",t.Bottom="Bottom",t.Left="Left",t.Right="Right"}(P||(P={}));const D="tab-count",I="scroll-mode",z="render-mode",j="active-tab",O="size-mode",U="tabs-position";let F=B=class extends g{constructor(){super(...arguments),this.mainElementContentWidthSubscription=null,this.contentPanelWidthSubscription=null,this.currentSize={width:null,height:null},this.contentSize={width:null,height:null},this.domChanges=[],this.scrollContainerElement=null,this.canTrackScroll=!1,this.tabCount=0,this.scrollMode=L.Auto,this.renderMode=N.Default,this.activeTab="",this.sizeMode=R.Medium,this.tabsPosition=P.Top,this.navElement=null,this.updateOverflowStateTimeout=0,this.minScrollStep=1,this.isReady=!1,this.neededSize=null,this.onScrollHandler=this.onScroll.bind(this),this.onNextButtonClickHandler=this.onScrollToNext.bind(this),this.onPrevButtonClickHandler=this.onScrollToPrev.bind(this),this.onClickHandler=this.onClick.bind(this),this.unsubscribeFocusUtils=null,this.unsubscribe=null}get isSideTabs(){return this.tabsPosition===P.Left||this.tabsPosition===P.Right}connectedOrContentChanged(){const t=this.querySelector(":scope > nav");t&&t!==this.navElement&&(this.navElement=t,this.dispose(),this.subscribeToEvents(),this.initialize(),this.isReady=!0)}disconnectedCallback(){super.disconnectedCallback(),this.disposeEvents(),this.dispose()}disposeEvents(){var t,e;null===(t=this.unsubscribe)||void 0===t||t.call(this),this.unsubscribe=null,null===(e=this.unsubscribeFocusUtils)||void 0===e||e.call(this),this.unsubscribeFocusUtils=null}subscribeToEvents(){if(!this.navElement)return;if(this.disposeEvents(),this.scrollMode!==L.NavButtons&&this.scrollMode!==L.Swipe)return;const t=this.getScrollContent();null==t||t.addEventListener("scroll",this.onScrollHandler),null==t||t.addEventListener("click",this.onClickHandler);const e=this.getPrevButton();null==e||e.addEventListener("click",this.onPrevButtonClickHandler);const i=this.getNextButton();null==i||i.addEventListener("click",this.onNextButtonClickHandler),this.unsubscribe=()=>{null==t||t.removeEventListener("scroll",this.onScrollHandler),null==t||t.removeEventListener("click",this.onClickHandler),null==e||e.removeEventListener("click",this.onPrevButtonClickHandler),null==i||i.removeEventListener("click",this.onNextButtonClickHandler)},this.unsubscribeFocusUtils=S(this.navElement)}dispose(){this.isReady=!1,this.updateOverflowStateTimeout&&(clearTimeout(this.updateOverflowStateTimeout),this.updateOverflowStateTimeout=0),this.mainElementContentWidthSubscription&&s(this.mainElementContentWidthSubscription),this.contentPanelWidthSubscription&&s(this.contentPanelWidthSubscription),this.neededSize=null}activate(t){if(!t)return;const e=document.querySelector(B.getSelector(M,t));if(null!=(null==e?void 0:e.parentNode)){const t=this.getListElement();for(let i=0;i<this.tabCount;i++)if(b.getChildByClassName(t.children[i],E.Item)===e){this.scrollToIndex(i);break}}}onScroll(t){this.updateOverflowState()}getContentElement(){return this.querySelector(`:scope > .${E.ContentPanel}`)}initialize(){l((()=>{this.prepareScrollMode(),e.DomUtils.addClassName(this.navElement,o.Loaded),this.checkForOverflow()})),this.mainElementContentWidthSubscription=r(this.navElement,(t=>{this.currentSize.width===t.width&&this.currentSize.height===t.height||(this.currentSize={width:t.width,height:t.height},this.checkForOverflow())}));const t=this.getContentElement();t&&(this.contentPanelWidthSubscription=r(t,(t=>{this.contentSize.width===t.width&&this.contentSize.height===t.height||(this.contentSize={width:t.width,height:t.height},this.onContentElementResize())})))}onContentElementResize(){this.updateSelectedContent()}updated(t){this.isReady&&((t.has("scrollMode")||t.has("tabCount")||t.has("sizeMode")||t.has("tabsPosition"))&&(l((()=>{this.prepareScrollMode(),this.checkForOverflow()})),this.subscribeToEvents()),t.has("activeTab")&&this.activate(this.activeTab),(t.has("renderMode")||t.has("activeTab"))&&this.updateSelectedContent(),super.updated(t))}queryUpdateOverflowState(t){this.updateOverflowStateTimeout&&clearTimeout(this.updateOverflowStateTimeout),this.updateOverflowStateTimeout=setTimeout((()=>{this.updateOverflowStateTimeout=0,this.updateOverflowState()}),t)}prepareScrollMode(){this.neededSize=this.scrollMode===L.NavButtons&&this.navElement?this.calcNeededSize():null}checkForOverflow(){if(!this.neededSize||!this.navElement)return;const t=this.isSideTabs?this.navElement.getBoundingClientRect().height-a(this.navElement):this.navElement.getBoundingClientRect().width-c(this.navElement);this.togleScrollState(t<this.neededSize)}togleScrollState(t){l((()=>{e.DomUtils.toggleClassName(this.navElement,E.HasOverflow,t),this.canTrackScroll=t,t&&this.queryUpdateOverflowState()}))}calcNeededSize(){var t;const e=null===(t=this.navElement)||void 0===t?void 0:t.getElementsByTagName("ul")[0];if(!e)return 0;let i=this.isSideTabs?a(e):c(e);const o=e.getElementsByTagName("li");for(const t of o)i+=this.isSideTabs?t.getBoundingClientRect().height+h(t):t.getBoundingClientRect().width+d(t);return i}updateOverflowState(){if(!this.canTrackScroll||this.scrollMode!==L.NavButtons)return;if(!this.findScrollContainer())return;const t=this.getScrollContent();if(!t)return;const[e,i]=this.getScrollAccess(t),o=this.getNextButton(),n=this.getPrevButton();u((()=>{o&&m(o,"disabled",!i),n&&m(n,"disabled",!e)}))}getScrollAccess(t){if(this.isSideTabs){const e=Math.ceil(t.scrollTop);return[e>0,Math.round(t.scrollHeight-e)-Math.round(t.clientHeight)>this.minScrollStep]}{const e=Math.ceil(t.scrollLeft);return[e>0,Math.round(t.scrollWidth-e)-Math.round(t.clientWidth)>this.minScrollStep]}}findScrollContainer(){if(!this.scrollContainerElement){if(!this.navElement)return null;this.scrollContainerElement=b.elementMatchesSelector(this.navElement,y)?this.navElement:this.navElement.querySelector(y)}return this.scrollContainerElement}getScrollContent(){return this.navElement?e.DomUtils.getNodesByClassName(this.navElement,i.ContentContainerClassName)[0]:null}getPrevButton(){var t;return null===(t=this.findScrollContainer())||void 0===t?void 0:t.querySelector(`:scope > .${E.ButtonScrollPrev}`)}getNextButton(){var t;return null===(t=this.findScrollContainer())||void 0===t?void 0:t.querySelector(`:scope > .${E.ButtonScrollNext}`)}onScrollToPrev(t){t.preventDefault();const e=this.findExtremeTabItemIndex(x.Back);this.scrollToIndex(e,x.Back)}onScrollToNext(t){t.preventDefault();const e=this.findExtremeTabItemIndex(x.Forward);this.scrollToIndex(e,x.Forward)}onClick(t){let e=t.target;for(;e;){if(p(e,E.Item)){const t=e.getAttribute(M);t&&this.activate(t);break}e=e.parentElement}}getListElement(){return this.navElement.getElementsByTagName("ul")[0]}getTabElement(t){return this.getListElement().querySelectorAll(":scope > li > ."+E.Item)[t]}scrollToIndex(t,e=x.None){var i,o;if(t>-1&&this.getScrollContent()){const n=t=>t.closest("li"),s=this.getTabElement(t),l=null===(i=n(s))||void 0===i?void 0:i.nextElementSibling,r=null===(o=n(s))||void 0===o?void 0:o.previousElementSibling;this.scrollToTab(s,r,l,e)}}findExtremeTabItemIndex(t){if(t===x.None)return-1;const e=this.getScrollContent();if(!e)return-1;const i=this.getListElement().querySelectorAll(":scope > li > ."+E.Item),o=this.getContentFrameRect(e),[n,s,l]=t===x.Forward?[0,this.tabCount,1]:[this.tabCount-1,-1,-1];for(let e=n;e!==s;e+=l){const n=i[e].getBoundingClientRect();if(this.isSideTabs){if(t===x.Back&&n.top<o.top||t===x.Forward&&n.bottom>o.bottom)return e}else if(t===x.Back&&n.left<o.left||t===x.Forward&&n.right>o.right)return e}return-1}getContentFrameRect(t){const i=e.DomUtils.getCurrentStyle(t),o=t.getBoundingClientRect();return new f(o.left+e.DomUtils.pxToInt(i.paddingLeft)+e.DomUtils.pxToInt(i.borderLeftWidth),o.top+e.DomUtils.pxToInt(i.paddingTop)+e.DomUtils.pxToInt(i.borderTopWidth),o.width-e.DomUtils.pxToInt(i.paddingRight)-e.DomUtils.pxToInt(i.borderRightWidth),o.height-e.DomUtils.pxToInt(i.paddingBottom)-e.DomUtils.pxToInt(i.borderBottomWidth))}scrollToTab(t,e,i,o){const n=this.getScrollContent();if(!n)return;const s=w.calculate(o,this.isSideTabs,this.getContentFrameRect(n),v.fromDomRect(t.getBoundingClientRect()),e?v.fromDomRect(e.getBoundingClientRect()):void 0,i?v.fromDomRect(i.getBoundingClientRect()):void 0);0!==s?this.isSideTabs?n.scrollTop+=s:n.scrollLeft+=s:n.scrollLeft>0&&o===x.Back&&(this.isSideTabs?n.scrollTop=0:n.scrollLeft=0)}updateSelectedContent(){const t=this.getContentElement();if(t){const i=this.activeTab?t.querySelector(B.getSelector(k,this.activeTab)):null,n=Array.from(t.querySelectorAll(`:scope > .${E.Content}${this.activeTab?`:not(${B.getSelector(k,this.activeTab)})`:""}`));l((()=>{if(i&&(i.style.cssText="",i.setAttribute("data-dx-tab-loaded","")),this.renderMode!==N.Default){const e=`position:absolute;visibility:hidden;left:-10000px;width:${t.clientWidth}px;height:${t.clientHeight}px`;n.forEach((t=>{t.style.cssText=e}))}t&&e.DomUtils.addClassName(t,o.Loaded)}))}}static getSelector(t,e){return`[${t}=${e}]`}};t([T({type:Number,attribute:D})],F.prototype,"tabCount",void 0),t([T({type:L,attribute:I})],F.prototype,"scrollMode",void 0),t([T({type:N,attribute:z})],F.prototype,"renderMode",void 0),t([T({attribute:j})],F.prototype,"activeTab",void 0),t([T({attribute:O})],F.prototype,"sizeMode",void 0),t([T({attribute:U})],F.prototype,"tabsPosition",void 0),F=B=t([C("dxbl-tabs")],F);const H={loadModule:function(){}};export{F as RibbonTabs,H as default};
